{
  "name": "Credit_Risk_ML_Pipeline",
  "description": "End-to-end credit risk assessment pipeline with ML training and inference",
  "email_notifications": {
    "on_failure": ["your-email@example.com"],
    "on_success": ["your-email@example.com"]
  },
  "schedule": {
    "quartz_cron_expression": "0 0 6 * * ?",
    "timezone_id": "Europe/Zurich",
    "pause_status": "PAUSED"
  },
  "max_concurrent_runs": 1,
  "tasks": [
    {
      "task_key": "setup_environment",
      "description": "Initialize environment, create databases and directories",
      "notebook_task": {
        "notebook_path": "/Users/{{current_user}}/credit_risk_pipeline/notebooks/00_setup_environment",
        "source": "WORKSPACE"
      },
      "job_cluster_key": "pipeline_cluster",
      "timeout_seconds": 600,
      "max_retries": 1
    },
    {
      "task_key": "bronze_ingestion",
      "description": "Ingest raw data into Bronze layer",
      "depends_on": [
        {"task_key": "setup_environment"}
      ],
      "notebook_task": {
        "notebook_path": "/Users/{{current_user}}/credit_risk_pipeline/notebooks/01_bronze_ingestion",
        "source": "WORKSPACE"
      },
      "job_cluster_key": "pipeline_cluster",
      "timeout_seconds": 1800,
      "max_retries": 2
    },
    {
      "task_key": "silver_transformation",
      "description": "Clean and transform data into Silver layer",
      "depends_on": [
        {"task_key": "bronze_ingestion"}
      ],
      "notebook_task": {
        "notebook_path": "/Users/{{current_user}}/credit_risk_pipeline/notebooks/02_silver_transformation",
        "source": "WORKSPACE"
      },
      "job_cluster_key": "pipeline_cluster",
      "timeout_seconds": 1800,
      "max_retries": 2
    },
    {
      "task_key": "gold_features",
      "description": "Create Gold layer features and aggregations",
      "depends_on": [
        {"task_key": "silver_transformation"}
      ],
      "notebook_task": {
        "notebook_path": "/Users/{{current_user}}/credit_risk_pipeline/notebooks/03_gold_aggregation",
        "source": "WORKSPACE"
      },
      "job_cluster_key": "pipeline_cluster",
      "timeout_seconds": 1800,
      "max_retries": 2
    },
    {
      "task_key": "ml_training",
      "description": "Train ML models and register best model",
      "depends_on": [
        {"task_key": "gold_features"}
      ],
      "notebook_task": {
        "notebook_path": "/Users/{{current_user}}/credit_risk_pipeline/notebooks/04_ml_training",
        "source": "WORKSPACE"
      },
      "job_cluster_key": "ml_cluster",
      "timeout_seconds": 7200,
      "max_retries": 1
    },
    {
      "task_key": "batch_inference",
      "description": "Run batch predictions on historical data",
      "depends_on": [
        {"task_key": "ml_training"}
      ],
      "notebook_task": {
        "notebook_path": "/Users/{{current_user}}/credit_risk_pipeline/notebooks/06_model_inference",
        "source": "WORKSPACE"
      },
      "job_cluster_key": "ml_cluster",
      "timeout_seconds": 3600,
      "max_retries": 1
    }
  ],
  "job_clusters": [
    {
      "job_cluster_key": "pipeline_cluster",
      "new_cluster": {
        "spark_version": "13.3.x-scala2.12",
        "node_type_id": "Standard_DS3_v2",
        "num_workers": 2,
        "spark_conf": {
          "spark.databricks.delta.preview.enabled": "true",
          "spark.databricks.delta.optimizeWrite.enabled": "true",
          "spark.databricks.delta.autoCompact.enabled": "true"
        },
        "spark_env_vars": {
          "PYSPARK_PYTHON": "/databricks/python3/bin/python3"
        }
      }
    },
    {
      "job_cluster_key": "ml_cluster",
      "new_cluster": {
        "spark_version": "13.3.x-cpu-ml-scala2.12",
        "node_type_id": "Standard_DS4_v2",
        "num_workers": 4,
        "spark_conf": {
          "spark.databricks.delta.preview.enabled": "true"
        },
        "spark_env_vars": {
          "PYSPARK_PYTHON": "/databricks/python3/bin/python3"
        }
      }
    }
  ],
  "tags": {
    "project": "credit_risk",
    "team": "data_engineering",
    "environment": "development"
  },
  "format": "MULTI_TASK"
}
